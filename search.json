[{"title":"企业微信对接gemini","url":"/blog/2024/02/18/企业微信对接gemini/","content":"chatgpt由于需要国外手机获取token才能调用api，过于麻烦一直没有折腾，后来发现谷歌的gemini可以直接生成apikey调用，而且官网也给了很多demo，比如python，go，nodejs等，所以就简单折腾一下。"},{"title":"第一次安装code-server碰到的问题","url":"/blog/2024/02/05/第一次安装code-server碰到的问题/","content":"因为在服务器上部署了hexo，每次又不想在本地再pull一份下来修改，就在服务器上又部署了一个code-server，这样就可以直接在网页修改代码，然后发布到github上，方便快捷，如果有点什么开发也可以直接网页调试，无需远程调试了。在部署的时候碰到几个问题，这里记录一下。\n\n<!--more-->\n## 服务端口被占用\n因为在服务器上安装了很多服务，例如像127.0.0.1:8080端口早就被别的服务占用了\n\n> The standalone arm64 .deb does not support Ubuntu 16.04 or earlier. Please\n> upgrade or [build with npm](#npm).\n\n```bash\ncurl -fOL https://github.com/coder/code-server/releases/download/v$VERSION/code-server_${VERSION}_amd64.deb\nsudo dpkg -i code-server_${VERSION}_amd64.deb\nsudo systemctl enable --now code-server@$USER\n# Now visit http://127.0.0.1:8080. Your password is in ~/.config/code-server/config.yaml\n```\n\n报错如下：\n```\nroot@kubernetes-master:/# systemctl status code-server@root\n× code-server@root.service - code-server\n     Loaded: loaded (/lib/systemd/system/code-server@.service; enabled; vendor preset: enabled)\n     Active: failed (Result: exit-code) since Mon 2024-02-05 09:52:00 CST; 37min ago\n   Main PID: 3855609 (code=exited, status=1/FAILURE)\n        CPU: 892ms\n\nFeb 05 09:52:00 kubernetes-master systemd[1]: code-server@root.service: Scheduled restart job, restart counter is at 5.\nFeb 05 09:52:00 kubernetes-master systemd[1]: Stopped code-server.\nFeb 05 09:52:00 kubernetes-master systemd[1]: code-server@root.service: Start request repeated too quickly.\nFeb 05 09:52:00 kubernetes-master systemd[1]: code-server@root.service: Failed with result 'exit-code'.\nFeb 05 09:52:00 kubernetes-master systemd[1]: Failed to start code-server.\n```\n\n但是这时配置文件也没有生成，查看service文件也没有提示有配置文件\n\n```\n~ cat /lib/systemd/system/code-server@.service\n[Unit]\nDescription=code-server\nAfter=network.target\n\n[Service]\nType=exec\nExecStart=/usr/bin/code-server\nRestart=always\nUser=%i\n\n[Install]\nWantedBy=default.target\n```\n\n这时尝试手工执行code-server命令，就会在用户目录下生成.config文件夹了，这时的报错也比较明显了：\n\n```\nroot@kubernetes-master:/# code-server\n[2024-02-05T02:30:25.326Z] info  Wrote default config file to /root/.config/code-server/config.yaml\n[2024-02-05T02:30:25.687Z] info  code-server 4.20.1 e76afa4a2bf4667a3c9f71bf56ef34b8ad365fbe\n[2024-02-05T02:30:25.687Z] info  Using user-data-dir /root/.local/share/code-server\n[2024-02-05T02:30:25.692Z] error listen EADDRINUSE: address already in use 127.0.0.1:8080\n\n```\n\n这时只需要去修改/root/.config/code-server/config.yaml文件，修改绑定的地址和端口就可以了。\n\nPS：也可能是我之前装了又删了导致，可能没有可复现性，而且既然装好了，自然也就不再折腾了\n\n## dominaname/code页面提示报错\n\nnginx的配置是这样的：\n```\nlocation /code/ {\n     proxy_pass http://127.0.0.1:9000;\n     # sendfile off;\n     add_header X-debug-message \"/code/\" always;\n     proxy_set_header   Host             $host;\n     proxy_set_header   X-Real-IP        $remote_addr;\n     proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;\n     rewrite  ^/code/(.*)  /$1 break;\n     }\n```\n报错是：\nAn unexpected error occurred that requires a reload of this page.\nThe workbench failed to connect to the server (Error: WebSocket close with status code 1006)\n加上以下3行即可：\n```\nproxy_set_header Upgrade $http_upgrade;\nproxy_set_header Connection upgrade;\nproxy_set_header Accept-Encoding gzip;\n```\n\n## 自带的terminal不能使用之前的alias，不能使用方向键\n\n直接使用bash就可以了，反正部署在云端，24小时不关机，bash一下，以后无忧呀。。。\n\n\n"},{"title":"个人博客上线","url":"/blog/2024/02/05/个人博客上线/","content":"大家好，这是我新创建的博客页面，这里仅会记录一些工作、生活上的事。。。"}]